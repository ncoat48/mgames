<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>Typing Speed Game</title>
  <style>
    :root {
      --bg: #0f1724;
      --card: #0b1220;
      --accent: #06b6d4;
      --muted: #94a3b8;
      --glass: rgba(255, 255, 255, 0.04)
    }

    html,
    body {
      height: 100%;
      margin: 0;
      font-family: Inter, system-ui, Segoe UI, Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg, #071022 0%, #071828 60%);
      color: #e6eef6
    }

    .back-btn-2 {
      position: fixed;
      top: 15px;
      left: 15px;
      padding: 8px 16px;
      font-size: 14px;
      background: #4a90e2;
      border: none;
      border-radius: 20px;
      color: white;
      text-decoration: none;
      cursor: pointer;
      z-index: 1000;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      font-family: Arial, sans-serif;
    }

    .back-btn-2:hover {
      background: #357ae8;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }

    .wrap {
      min-height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 28px
    }

    .card {
      width: 100%;
      max-width: 980px;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), rgba(255, 255, 255, 0.01));
      border-radius: 14px;
      padding: 18px;
      box-shadow: 0 8px 30px rgba(2, 6, 23, 0.6);
      border: 1px solid rgba(255, 255, 255, 0.03)
    }

    header {
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: space-between
    }

    h1 {
      font-size: 20px;
      margin: 0
    }

    .controls {
      display: flex;
      gap: 8px;
      align-items: center
    }

    select,
    input[type=number] {
      background: var(--glass);
      border: 1px solid rgba(255, 255, 255, 0.04);
      padding: 8px;
      border-radius: 8px;
      color: inherit
    }

    button {
      background: var(--accent);
      border: none;
      padding: 10px 14px;
      border-radius: 10px;
      color: #022;
      cursor: pointer;
      font-weight: 600
    }

    .board {
      display: grid;
      grid-template-columns: 1fr 320px;
      gap: 18px;
      margin-top: 18px
    }

    @media (max-width:900px) {
      .board {
        grid-template-columns: 1fr
      }

      .stats {
        order: 2
      }
    }

    .text-area {
      background: rgba(255, 255, 255, 0.02);
      padding: 14px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.02)
    }

    .words {
      min-height: 140px;
      line-height: 1.9;
      font-size: 20px;
      color: var(--muted);
      word-break: break-word
    }

    .word.active {
      color: #fff;
      background: rgba(255, 255, 255, 0.03);
      padding: 2px 6px;
      border-radius: 6px
    }

    .word.correct {
      color: #22c55e
    }

    .word.incorrect {
      color: #ef4444;
      text-decoration: line-through
    }

    .input-row {
      display: flex;
      gap: 8px;
      margin-top: 12px
    }

    .input-row input {
      flex: 1;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.03);
      font-size: 18px;
      background: transparent;
      color: inherit
    }

    .stats {
      background: rgba(255, 255, 255, 0.01);
      padding: 14px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.02)
    }

    .stat {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px
    }

    .small {
      font-size: 13px;
      color: var(--muted)
    }

    .big {
      font-size: 28px;
      font-weight: 700
    }

    .footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 12px;
      color: var(--muted);
      font-size: 13px
    }

    .hint {
      font-size: 13px;
      color: var(--muted)
    }

    .mobile-help {
      display: none
    }

    @media (max-width:600px) {
      .mobile-help {
        display: block;
        margin-top: 10px
      }
    }

    .settings-row {
      display: flex;
      gap: 8px;
      align-items: center
    }

    .buttons-row {
      display: flex;
      gap: 8px
    }

    .topline {
      display: flex;
      gap: 10px;
      align-items: center
    }

    .leader {
      font-size: 13px;
      color: var(--muted)
    }
  </style>
</head>

<body>
  <a href="../index.html" class="back-btn-2">← Back</a>

  <div class="wrap">
    <div class="card" role="main">
      <header>
        <div>
          <h1>Typing Speed Game</h1>
          <div class="small">Play on PC or Android — touch friendly and responsive</div>
        </div>
        <div class="controls">
          <div class="settings-row">
            <label class="small">Time</label>
            <select id="duration">
              <option value="15">15s</option>
              <option value="30" selected>30s</option>
              <option value="60">60s</option>
              <option value="120">120s</option>
            </select>
            <label class="small">Mode</label>
            <select id="mode">
              <option value="words">Words</option>
              <option value="quote">Quote</option>
            </select>
          </div>
          <div class="buttons-row">
            <button id="start">Start</button>
            <button id="restart">Reset</button>
          </div>
        </div>
      </header>

      <div class="board">
        <div class="text-area">
          <div class="topline">
            <div class="leader">Tip: press <span class="small">Space</span> to submit a word. On mobile, use the
              keyboard's space or enter.</div>
          </div>
          <div class="words" id="words" aria-live="polite"></div>
          <div class="input-row">
            <input id="typed" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"
              placeholder="Type the highlighted word..." />
            <button id="skip">Skip</button>
          </div>
          <div class="mobile-help small">If the on-screen keyboard hides the words, press the keyboard's hide button or
            rotate the phone. You can also play landscape for a wider view.</div>
        </div>

        <aside class="stats">
          <div class="stat">
            <div class="small">Time</div>
            <div id="time" class="big">30</div>
          </div>
          <div class="stat">
            <div class="small">WPM</div>
            <div id="wpm" class="big">0</div>
          </div>
          <div class="stat">
            <div class="small">Accuracy</div>
            <div id="acc" class="big">100%</div>
          </div>
          <div class="stat">
            <div class="small">Correct</div>
            <div id="correct" class="big">0</div>
          </div>
          <div class="stat">
            <div class="small">Incorrect</div>
            <div id="incorrect" class="big">0</div>
          </div>
          <hr style="border:none;border-top:1px solid rgba(255,255,255,0.03);margin:10px 0">
          <div class="small">Best WPM <span id="best" class="leader">—</span></div>
        </aside>
      </div>

      <div class="footer">
        <div class="hint">Words source: built-in wordlist. You can replace words array inside the code to customise.
        </div>
        <div class="small">Made for browsers — Android Chrome, Firefox, Edge, desktop browsers supported.</div>
      </div>
    </div>
  </div>

  <script>
    // --- Simple wordlist (replace or expand) ---
    const WORDS = (`
      ability about above accept access account across action activity actor actually
      add address admit adult affect after again against age agency agent agree ahead
      allow almost alone along already also although always among amount analysis
      animal answer anyone anything appear apply area argue around arrive artist
      ask assume attack attention attorney audience author authority available avoid
      baby back bad bag bank bar base be beat beauty because become before begin
      believe benefit best better between beyond big bill billion bit black blood
      blue board body book born both box boy break bring brother budget build
      building business but buy by call camera campaign campus cancer candidate
      capital car card care career carry case catch cause cell center central century
      certain certainly chair challenge chance change check child choice choose church
    `).trim().split(/\s+/);

    // --- Elements ---
    const wordsEl = document.getElementById('words');
    const typed = document.getElementById('typed');
    const startBtn = document.getElementById('start');
    const restartBtn = document.getElementById('restart');
    const skipBtn = document.getElementById('skip');
    const timeEl = document.getElementById('time');
    const wpmEl = document.getElementById('wpm');
    const accEl = document.getElementById('acc');
    const correctEl = document.getElementById('correct');
    const incorrectEl = document.getElementById('incorrect');
    const bestEl = document.getElementById('best');
    const durationSelect = document.getElementById('duration');
    const modeSelect = document.getElementById('mode');

    // --- State ---
    let sequence = [];
    let currentIndex = 0;
    let timer = null;
    let timeLeft = parseInt(durationSelect.value, 10);
    let running = false;
    let startedAt = null;
    let totalTypedChars = 0; // for accuracy (including incorrect)
    let correctChars = 0;
    let correctWords = 0;
    let incorrectWords = 0;

    // --- LocalStorage best ---
    const BEST_KEY = 'typing_game_best_wpm_v1';
    const best = localStorage.getItem(BEST_KEY);
    if (best) bestEl.textContent = Math.round(best);
    else bestEl.textContent = '—';

    // --- Helpers ---
    function pickWords(n = 80) {
      const out = [];
      for (let i = 0; i < n; i++) {
        out.push(WORDS[Math.floor(Math.random() * WORDS.length)]);
      }
      return out;
    }

    function renderWords() {
      wordsEl.innerHTML = '';
      sequence.forEach((w, i) => {
        const span = document.createElement('span');
        span.textContent = w + (i === sequence.length - 1 ? '' : ' ');
        span.className = 'word' + (i === currentIndex ? ' active' : '');
        span.dataset.index = i;
        wordsEl.appendChild(span);
      });
      scrollActiveIntoView();
    }

    function scrollActiveIntoView() {
      const active = wordsEl.querySelector('.word.active');
      if (active) {
        active.scrollIntoView({ block: 'nearest', inline: 'nearest' });
      }
    }

    function startGame() {
      if (running) return;
      resetStats();
      running = true;
      timeLeft = parseInt(durationSelect.value, 10);
      timeEl.textContent = timeLeft;
      if (modeSelect.value === 'words') sequence = pickWords(200);
      else sequence = [
        "The quick brown fox jumps over the lazy dog",
        "Typing quickly takes practice and concentration",
        "Practice a little every day and you'll improve"
      ].join(' ').split(/\s+/);
      currentIndex = 0;
      renderWords();
      typed.value = '';
      typed.disabled = false;
      typed.focus({ preventScroll: true });
      startedAt = Date.now();
      timer = setInterval(tick, 1000);
      startBtn.textContent = 'Running...';
      startBtn.disabled = true;
    }

    function resetStats() {
      totalTypedChars = 0; correctChars = 0; correctWords = 0; incorrectWords = 0;
      updateStats();
    }

    function endGame() {
      running = false;
      clearInterval(timer);
      timer = null;
      typed.disabled = true;
      startBtn.textContent = 'Start';
      startBtn.disabled = false;
      // calculate WPM: (correctChars/5) / minutes
      const elapsedSec = (parseInt(durationSelect.value, 10) - timeLeft) || 1;
      const minutes = elapsedSec / 60;
      const wpm = minutes > 0 ? Math.round((correctChars / 5) / minutes) : 0;
      wpmEl.textContent = wpm;
      // save best
      const prevBest = parseInt(localStorage.getItem(BEST_KEY) || '0', 10);
      if (wpm > prevBest) {
        localStorage.setItem(BEST_KEY, wpm);
        bestEl.textContent = wpm;
      }
    }

    function tick() {
      timeLeft--; if (timeLeft < 0) timeLeft = 0;
      timeEl.textContent = timeLeft;
      updateStats();
      if (timeLeft <= 0) {
        endGame();
      }
    }

    function updateStats() {
      const elapsed = (parseInt(durationSelect.value, 10) - timeLeft) || 0.0001;
      const minutes = elapsed / 60;
      const wpm = minutes > 0 ? Math.round((correctChars / 5) / minutes) : 0;
      const acc = totalTypedChars > 0 ? Math.max(0, Math.round((correctChars / totalTypedChars) * 100)) : 100;
      wpmEl.textContent = wpm;
      accEl.textContent = acc + '%';
      correctEl.textContent = correctWords;
      incorrectEl.textContent = incorrectWords;
    }

    function submitCurrentWord() {
      const currentWord = sequence[currentIndex];
      const typedVal = typed.value.trim();
      // count chars
      totalTypedChars += typedVal.length;
      // count correct chars vs target
      for (let i = 0; i < Math.max(typedVal.length, currentWord.length); i++) {
        if (typedVal[i] && currentWord[i] && typedVal[i] === currentWord[i]) correctChars++;
      }

      const spans = wordsEl.querySelectorAll('.word');
      const curSpan = spans[currentIndex];
      if (typedVal === currentWord) {
        curSpan.classList.remove('active');
        curSpan.classList.add('correct');
        correctWords++;
      } else {
        curSpan.classList.remove('active');
        curSpan.classList.add('incorrect');
        incorrectWords++;
      }

      currentIndex++;
      if (currentIndex >= sequence.length) {
        // regenerate some more words
        sequence = sequence.concat(pickWords(50));
      }
      renderWords();
      typed.value = '';
      scrollActiveIntoView();
      updateStats();
    }

    // --- Events ---
    typed.addEventListener('keydown', (e) => {
      if (!running && (e.key === ' ' || e.key === 'Enter')) {
        // quick start when user types
        e.preventDefault();
        startGame();
        return;
      }
      if (!running) return;
      if (e.key === ' ') {
        e.preventDefault();
        submitCurrentWord();
      }
      if (e.key === 'Enter') {
        e.preventDefault();
        submitCurrentWord();
      }
      // block paste
      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'v') {
        e.preventDefault();
      }
    });

    skipBtn.addEventListener('click', () => {
      if (!running) return;
      // mark as incorrect and move on
      const spans = wordsEl.querySelectorAll('.word');
      const curSpan = spans[currentIndex];
      curSpan.classList.remove('active');
      curSpan.classList.add('incorrect');
      incorrectWords++;
      currentIndex++;
      typed.value = '';
      renderWords();
      typed.focus({ preventScroll: true });
      updateStats();
    });

    startBtn.addEventListener('click', startGame);
    restartBtn.addEventListener('click', () => {
      clearInterval(timer); timer = null; running = false; startBtn.textContent = 'Start'; startBtn.disabled = false;
      timeLeft = parseInt(durationSelect.value, 10); timeEl.textContent = timeLeft;
      sequence = pickWords(120); currentIndex = 0; renderWords(); typed.value = ''; typed.disabled = false; resetStats();
    });

    durationSelect.addEventListener('change', () => {
      if (!running) timeEl.textContent = durationSelect.value;
    });

    modeSelect.addEventListener('change', () => {
      if (!running) {
        if (modeSelect.value === 'words') sequence = pickWords(120);
        else sequence = ["A short sample sentence for practice"].join(' ').split(/\s+/);
        currentIndex = 0; renderWords();
      }
    });

    // Prevent pasting into input (makes cheating easier in this simple game)
    typed.addEventListener('paste', (e) => { e.preventDefault(); });

    // init
    sequence = pickWords(120);
    renderWords();
    timeEl.textContent = durationSelect.value;
    typed.disabled = false;

    // Small polish: tap the word to move caret to that word's index (useful on mobile)
    wordsEl.addEventListener('click', (e) => {
      const w = e.target.closest('.word');
      if (!w) return;
      const idx = parseInt(w.dataset.index, 10);
      if (Number.isFinite(idx)) {
        // allow jumping only if not running
        if (!running) { currentIndex = idx; renderWords(); }
      }
    });

    // Accessibility: On small screens focus typed when user taps the card
    document.querySelector('.card').addEventListener('click', () => {
      if (window.innerWidth <= 900) { typed.focus({ preventScroll: true }); }
    });

  </script>
</body>

</html>